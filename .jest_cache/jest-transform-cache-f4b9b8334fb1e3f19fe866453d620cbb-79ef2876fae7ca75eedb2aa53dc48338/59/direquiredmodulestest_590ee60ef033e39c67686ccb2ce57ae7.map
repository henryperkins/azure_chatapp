{"version":3,"names":["_knowledgeBaseManager","require","_chatExtensions","describe","it","ctx","eventHandlers","domAPI","logger","info","warn","error","getDep","expect","createKnowledgeBaseManager","toThrow","options","DependencySystem","chatManager","app","featureFlags","EXT_CHAT","domReadinessService","createChatExtensions"],"sources":["di-required-modules.test.js"],"sourcesContent":["// Contract tests to ensure that critical modules fail fast when mandatory\n// dependencies are missing. These tests protect against “temporary” stubs\n// silently shipping to production.\n\nimport { createKnowledgeBaseManager } from \"../static/js/knowledgeBaseManager.js\";\nimport { createChatExtensions } from \"../static/js/chatExtensions.js\";\n\ndescribe(\"Dependency completeness contracts\", () => {\n  describe(\"createKnowledgeBaseManager\", () => {\n    it(\"throws if apiRequest dependency is missing\", () => {\n      const ctx = {\n        // Provide required non-apiRequest deps\n        eventHandlers: {},\n        domAPI: {},\n        logger: { info: () => {}, warn: () => {}, error: () => {} },\n        // Ensure getDep returns null so fallback via DS fails\n        getDep: () => null,\n        // No app / apiRequest intentionally\n      };\n\n      expect(() => createKnowledgeBaseManager(ctx)).toThrow(\n        /Missing required dependency 'apiRequest'/\n      );\n    });\n  });\n\n  describe(\"createChatExtensions\", () => {\n    it(\"throws when feature flag is off\", () => {\n      const options = {\n        DependencySystem: {},\n        eventHandlers: {},\n        chatManager: {},\n        app: { featureFlags: { EXT_CHAT: false } },\n        domAPI: {},\n        domReadinessService: {},\n        logger: { info: () => {}, warn: () => {}, error: () => {} },\n      };\n\n      expect(() => createChatExtensions(options)).toThrow(\n        /disabled by feature flag EXT_CHAT=off/\n      );\n    });\n  });\n});\n"],"mappings":";;AAIA,IAAAA,qBAAA,GAAAC,OAAA;AACA,IAAAC,eAAA,GAAAD,OAAA;AALA;AACA;AACA;;AAKAE,QAAQ,CAAC,mCAAmC,EAAE,MAAM;EAClDA,QAAQ,CAAC,4BAA4B,EAAE,MAAM;IAC3CC,EAAE,CAAC,4CAA4C,EAAE,MAAM;MACrD,MAAMC,GAAG,GAAG;QACV;QACAC,aAAa,EAAE,CAAC,CAAC;QACjBC,MAAM,EAAE,CAAC,CAAC;QACVC,MAAM,EAAE;UAAEC,IAAI,EAAEA,CAAA,KAAM,CAAC,CAAC;UAAEC,IAAI,EAAEA,CAAA,KAAM,CAAC,CAAC;UAAEC,KAAK,EAAEA,CAAA,KAAM,CAAC;QAAE,CAAC;QAC3D;QACAC,MAAM,EAAEA,CAAA,KAAM;QACd;MACF,CAAC;MAEDC,MAAM,CAAC,MAAM,IAAAC,gDAA0B,EAACT,GAAG,CAAC,CAAC,CAACU,OAAO,CACnD,0CACF,CAAC;IACH,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFZ,QAAQ,CAAC,sBAAsB,EAAE,MAAM;IACrCC,EAAE,CAAC,iCAAiC,EAAE,MAAM;MAC1C,MAAMY,OAAO,GAAG;QACdC,gBAAgB,EAAE,CAAC,CAAC;QACpBX,aAAa,EAAE,CAAC,CAAC;QACjBY,WAAW,EAAE,CAAC,CAAC;QACfC,GAAG,EAAE;UAAEC,YAAY,EAAE;YAAEC,QAAQ,EAAE;UAAM;QAAE,CAAC;QAC1Cd,MAAM,EAAE,CAAC,CAAC;QACVe,mBAAmB,EAAE,CAAC,CAAC;QACvBd,MAAM,EAAE;UAAEC,IAAI,EAAEA,CAAA,KAAM,CAAC,CAAC;UAAEC,IAAI,EAAEA,CAAA,KAAM,CAAC,CAAC;UAAEC,KAAK,EAAEA,CAAA,KAAM,CAAC;QAAE;MAC5D,CAAC;MAEDE,MAAM,CAAC,MAAM,IAAAU,oCAAoB,EAACP,OAAO,CAAC,CAAC,CAACD,OAAO,CACjD,uCACF,CAAC;IACH,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]}