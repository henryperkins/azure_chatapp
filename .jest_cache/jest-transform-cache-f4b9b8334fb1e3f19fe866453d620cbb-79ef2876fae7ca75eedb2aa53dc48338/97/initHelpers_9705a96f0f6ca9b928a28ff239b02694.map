{"version":3,"names":["safeInit","instance","name","methodName","logger","error","Error","warn","context","result","undefined","err","createDomWaitHelper","domReadinessService","waitForDependenciesAndElements","deps","domSelectors","timeout","dependenciesAndElements","createTimeoutWrapper","browserService","withTimeout","operation","timeoutMs","operationName","Promise","race","_","reject","getWindow","setTimeout","createInitHelpers","domWaitHelper","timeoutWrapper","cleanup"],"sources":["initHelpers.js"],"sourcesContent":["/**\n * @module InitHelpers\n * Shared initialization utilities to eliminate duplication across init modules\n */\n\n/**\n * Safely invokes an asynchronous initialization method on a given instance, logging warnings or errors as needed.\n *\n * Attempts to call the specified method on the provided instance. Logs a warning if the instance or method is missing, and logs and rethrows any errors encountered during execution.\n *\n * @param {object} instance - The object containing the initialization method.\n * @param {string} name - The name of the instance, used for logging context.\n * @param {string} methodName - The name of the method to invoke.\n * @param {object} logger - Logger instance for logging\n * @returns {Promise<boolean>} Resolves to `true` if initialization succeeds or the method returns `undefined`; otherwise, resolves to the boolean value of the method's result. Returns `false` if the instance or method is missing.\n *\n * @throws {Error} If the initialization method throws an error during execution.\n */\nexport async function safeInit(instance, name, methodName, logger) {\n  if (!logger || typeof logger.error !== 'function')\n    throw new Error('[safeInit] logger is required');\n  if (!instance) {\n    logger?.warn(`[safeInit] Instance ${name} is null/undefined. Cannot call ${methodName}.`, { context: `initHelpers:safeInit:${name}` });\n    return false;\n  }\n  if (typeof instance[methodName] !== 'function') {\n    logger?.warn(`[safeInit] Method ${methodName} not found on ${name}.`, { context: `initHelpers:safeInit:${name}` });\n    return false;\n  }\n  try {\n    const result = await instance[methodName]();\n    return result === undefined ? true : !!result;\n  } catch (err) {\n    logger.error(`[safeInit] Error during ${name}.${methodName}()`, err, { context: `initHelpers:safeInit:${name}:${methodName}` });\n    throw err;\n  }\n}\n\n/**\n * Creates a standardized DOM readiness helper with common patterns\n * @param {object} domReadinessService - The DOM readiness service\n * @param {object} logger - Logger instance\n * @returns {function} Helper function for waiting on dependencies and elements\n */\nexport function createDomWaitHelper(domReadinessService, logger) {\n  return async function waitForDependenciesAndElements({\n    deps = [],\n    domSelectors = [],\n    timeout = 10000,\n    context = 'unknown'\n  } = {}) {\n    try {\n      await domReadinessService.dependenciesAndElements({\n        deps,\n        domSelectors,\n        timeout,\n        context\n      });\n      return true;\n    } catch (err) {\n      logger.error('[domWaitHelper] Failed to wait for dependencies/elements', err, { \n        context, \n        deps, \n        domSelectors, \n        timeout \n      });\n      throw err;\n    }\n  };\n}\n\n/**\n * Creates a standardized timeout wrapper for async operations\n * @param {object} browserService - Browser service for setTimeout\n * @param {object} logger - Logger instance\n * @returns {function} Helper function for wrapping operations with timeout\n */\nexport function createTimeoutWrapper(browserService, logger) {\n  return function withTimeout(operation, timeoutMs, operationName = 'operation') {\n    return Promise.race([\n      operation,\n      new Promise((_, reject) =>\n        browserService.getWindow().setTimeout(\n          () => reject(new Error(`Timeout in ${operationName} after ${timeoutMs}ms`)),\n          timeoutMs\n        )\n      )\n    ]);\n  };\n}\n\n/**\n * Factory function to create init helpers with injected dependencies\n * @param {object} dependencies - Required dependencies\n * @param {object} dependencies.domReadinessService - DOM readiness service\n * @param {object} dependencies.browserService - Browser service\n * @param {object} dependencies.logger - Logger instance\n * @returns {object} Collection of helper functions\n */\nexport function createInitHelpers({ domReadinessService, browserService, logger }) {\n  if (!domReadinessService || !browserService || !logger) {\n    throw new Error('[initHelpers] Missing required dependencies: domReadinessService, browserService, logger');\n  }\n\n  const domWaitHelper = createDomWaitHelper(domReadinessService, logger);\n  const timeoutWrapper = createTimeoutWrapper(browserService, logger);\n\n  return {\n    safeInit: (instance, name, methodName) => safeInit(instance, name, methodName, logger),\n    waitForDependenciesAndElements: domWaitHelper,\n    withTimeout: timeoutWrapper,\n    cleanup () {}\n  };\n}\n"],"mappings":"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","ignoreList":[]}