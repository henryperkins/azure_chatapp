{"version":3,"names":["createStorageService","browserService","APP_CONFIG","logger","DependencySystem","Error","safe","fn","_fallback","ctx","err","error","context","message","getItem","k","setItem","v","undefined","removeItem","clear","key","n","length","cleanup"],"sources":["storageService.js"],"sourcesContent":["/**\n * storageService.js â€” DI-safe localStorage wrapper (from globalUtils).\n * Uses browserService for access.\n *\n * Usage:\n *   import { createStorageService } from './storageService.js';\n *   const storage = createStorageService({ browserService, APP_CONFIG });\n */\n\nexport function createStorageService({ browserService, APP_CONFIG, logger, DependencySystem }) {\n  if (!browserService) throw new Error('[storageService] browserService required');\n  if (!logger) throw new Error('[storageService] logger required');\n  function safe(fn, _fallback, ctx) {\n    try {\n      return fn();\n    } catch (err) {\n      logger.error(`[storageService] ${ctx} failed`, err,\n                   { context: `storageService:${ctx}` });\n      throw new Error(`[storageService] ${ctx} failed and fallback is forbidden: ${err?.message || err}`);\n    }\n  }\n\n  return {\n    getItem: (k) => safe(() => browserService.getItem(k), null, \"getItem\"),\n    setItem: (k, v) => safe(() => browserService.setItem(k, v), undefined, \"setItem\"),\n    removeItem: (k) => safe(() => browserService.removeItem(k), undefined, \"removeItem\"),\n    clear: () => safe(() => browserService.clear?.(), undefined, \"clear\"),\n    key: (n) => safe(() => browserService.key?.(n), null, \"key\"),\n    get length() {\n      return safe(() => browserService.length ?? 0, 0, \"length\");\n    },\n    cleanup () {}\n  };\n}\n"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEO,SAASA,oBAAoBA,CAAC;EAAEC,cAAc;EAAEC,UAAU;EAAEC,MAAM;EAAEC;AAAiB,CAAC,EAAE;EAC7F,IAAI,CAACH,cAAc,EAAE,MAAM,IAAII,KAAK,CAAC,0CAA0C,CAAC;EAChF,IAAI,CAACF,MAAM,EAAE,MAAM,IAAIE,KAAK,CAAC,kCAAkC,CAAC;EAChE,SAASC,IAAIA,CAACC,EAAE,EAAEC,SAAS,EAAEC,GAAG,EAAE;IAChC,IAAI;MACF,OAAOF,EAAE,CAAC,CAAC;IACb,CAAC,CAAC,OAAOG,GAAG,EAAE;MACZP,MAAM,CAACQ,KAAK,CAAC,oBAAoBF,GAAG,SAAS,EAAEC,GAAG,EACrC;QAAEE,OAAO,EAAE,kBAAkBH,GAAG;MAAG,CAAC,CAAC;MAClD,MAAM,IAAIJ,KAAK,CAAC,oBAAoBI,GAAG,sCAAsCC,GAAG,EAAEG,OAAO,IAAIH,GAAG,EAAE,CAAC;IACrG;EACF;EAEA,OAAO;IACLI,OAAO,EAAGC,CAAC,IAAKT,IAAI,CAAC,MAAML,cAAc,CAACa,OAAO,CAACC,CAAC,CAAC,EAAE,IAAI,EAAE,SAAS,CAAC;IACtEC,OAAO,EAAEA,CAACD,CAAC,EAAEE,CAAC,KAAKX,IAAI,CAAC,MAAML,cAAc,CAACe,OAAO,CAACD,CAAC,EAAEE,CAAC,CAAC,EAAEC,SAAS,EAAE,SAAS,CAAC;IACjFC,UAAU,EAAGJ,CAAC,IAAKT,IAAI,CAAC,MAAML,cAAc,CAACkB,UAAU,CAACJ,CAAC,CAAC,EAAEG,SAAS,EAAE,YAAY,CAAC;IACpFE,KAAK,EAAEA,CAAA,KAAMd,IAAI,CAAC,MAAML,cAAc,CAACmB,KAAK,GAAG,CAAC,EAAEF,SAAS,EAAE,OAAO,CAAC;IACrEG,GAAG,EAAGC,CAAC,IAAKhB,IAAI,CAAC,MAAML,cAAc,CAACoB,GAAG,GAAGC,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,CAAC;IAC5D,IAAIC,MAAMA,CAAA,EAAG;MACX,OAAOjB,IAAI,CAAC,MAAML,cAAc,CAACsB,MAAM,IAAI,CAAC,EAAE,CAAC,EAAE,QAAQ,CAAC;IAC5D,CAAC;IACDC,OAAOA,CAAA,EAAI,CAAC;EACd,CAAC;AACH","ignoreList":[]}