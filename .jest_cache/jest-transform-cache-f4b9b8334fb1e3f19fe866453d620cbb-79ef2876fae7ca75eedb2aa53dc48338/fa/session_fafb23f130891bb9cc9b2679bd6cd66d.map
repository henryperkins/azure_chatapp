{"version":3,"names":["sessionId","_browserService","setBrowserService","bs","generateSessionId","cryptoObj","getWindow","crypto","randomUUID","Error","getSessionId","resetSessionId","createSessionManager","browserService","logger","log","debug","error","cleanup","context"],"sources":["session.js"],"sourcesContent":["/**\n * session.js - Generate and provide a session UUID for this app/browser tab.\n * Used for correlating frontend logs/errors across notifications.\n */\nlet sessionId = null;\nlet _browserService = null;\nexport function setBrowserService(bs) { _browserService = bs; }\nfunction generateSessionId() {\n  // Generate RFC4122v4 string; crypto randomUUID is required\n  const cryptoObj = _browserService?.getWindow?.()?.crypto;\n  if (cryptoObj?.randomUUID) return cryptoObj.randomUUID();\n  throw new Error('[session.js] crypto.randomUUID is required; fallback UUID generation is forbidden.');\n}\nexport function getSessionId() {\n  if (!sessionId) sessionId = generateSessionId();\n  return sessionId;\n}\nexport function resetSessionId(){ sessionId=null; }\n\nexport function createSessionManager({ browserService, logger } = {}) {\n  if (!browserService) throw new Error('[session] browserService required');\n  setBrowserService(browserService);\n  const log = logger ?? { debug(){}, error(){} };\n  return {\n    getSessionId,\n    resetSessionId,\n    cleanup () {\n      resetSessionId();\n      setBrowserService(null);\n      log.debug('[session] cleaned up', { context: 'session:cleanup' });\n    }\n  };\n}\n"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AACA,IAAIA,SAAS,GAAG,IAAI;AACpB,IAAIC,eAAe,GAAG,IAAI;AACnB,SAASC,iBAAiBA,CAACC,EAAE,EAAE;EAAEF,eAAe,GAAGE,EAAE;AAAE;AAC9D,SAASC,iBAAiBA,CAAA,EAAG;EAC3B;EACA,MAAMC,SAAS,GAAGJ,eAAe,EAAEK,SAAS,GAAG,CAAC,EAAEC,MAAM;EACxD,IAAIF,SAAS,EAAEG,UAAU,EAAE,OAAOH,SAAS,CAACG,UAAU,CAAC,CAAC;EACxD,MAAM,IAAIC,KAAK,CAAC,oFAAoF,CAAC;AACvG;AACO,SAASC,YAAYA,CAAA,EAAG;EAC7B,IAAI,CAACV,SAAS,EAAEA,SAAS,GAAGI,iBAAiB,CAAC,CAAC;EAC/C,OAAOJ,SAAS;AAClB;AACO,SAASW,cAAcA,CAAA,EAAE;EAAEX,SAAS,GAAC,IAAI;AAAE;AAE3C,SAASY,oBAAoBA,CAAC;EAAEC,cAAc;EAAEC;AAAO,CAAC,GAAG,CAAC,CAAC,EAAE;EACpE,IAAI,CAACD,cAAc,EAAE,MAAM,IAAIJ,KAAK,CAAC,mCAAmC,CAAC;EACzEP,iBAAiB,CAACW,cAAc,CAAC;EACjC,MAAME,GAAG,GAAGD,MAAM,IAAI;IAAEE,KAAKA,CAAA,EAAE,CAAC,CAAC;IAAEC,KAAKA,CAAA,EAAE,CAAC;EAAE,CAAC;EAC9C,OAAO;IACLP,YAAY;IACZC,cAAc;IACdO,OAAOA,CAAA,EAAI;MACTP,cAAc,CAAC,CAAC;MAChBT,iBAAiB,CAAC,IAAI,CAAC;MACvBa,GAAG,CAACC,KAAK,CAAC,sBAAsB,EAAE;QAAEG,OAAO,EAAE;MAAkB,CAAC,CAAC;IACnE;EACF,CAAC;AACH","ignoreList":[]}