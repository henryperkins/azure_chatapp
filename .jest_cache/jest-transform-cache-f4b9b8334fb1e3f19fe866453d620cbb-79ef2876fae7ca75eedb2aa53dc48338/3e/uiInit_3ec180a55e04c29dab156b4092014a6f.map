{"version":3,"names":["createUIInit","deps","DependencySystem","domAPI","browserService","eventHandlers","domReadinessService","logger","APP_CONFIG","safeHandler","sanitizer","createProjectDetailsEnhancements","createTokenStatsManager","createKnowledgeBaseComponent","uiUtils","Error","_uiInitialized","setupSidebarControls","log","context","loadProjectTemplates","htmlLoader","modules","get","loadTemplate","error","url","containerSelector","eventName","err","waitForModalReadiness","modalMgr","isReadyPromise","timeoutMS","timedOut","Promise","race","_","reject","getWindow","setTimeout","ensureBaseProjectContainers","info","doc","getDocument","panel","querySelector","body","listFound","detailsFound","list","createElement","id","className","dataset","dynamic","appendChild","details","createAndRegisterUIComponents","inst","register","initialize","catch","apiClient","modalManager","projectManager","app","chatManager","proxy","__isProxy","setRealManager","delete","pdDashboard","pdc","plc","setProjectDetailsComponent","setProjectListComponent","__initialized","waitForEvent","timeout","registerNavigationViews","navSvc","registerView","hasView","show","dash","components","projectList","hide","projectId","dependenciesAndElements","showProjectDetails","kbComp","isInitialized","debug","projectDetails","hideProjectDetails","initializeUIComponents","domSelectors","observeMutations","TIMEOUTS","PROJECT_LIST_ELEMENTS","init","emitReplayable","appModule","setAppLifecycleState","isReady","currentPhase","earlyEmitErr","warn","e","sidebar","mobileDock","getMobileDock","ensureMobileDock","sidebarAuth","getSidebarAuth","setupInlineAuthForm","forceAuthStateSync","syncErr","a11yUtils","cleanup","cleanupListeners","waitForModalReadinessWithTimeout"],"sources":["uiInit.js"],"sourcesContent":["// ========================================\n// FILE: /initialization/phases/uiInit.js\n// ========================================\n/**\n * UI Components Initialization\n * Handles template loading, component creation, and navigation setup\n * ~250 lines\n */\n\nexport function createUIInit(deps) {\n    const {\n        DependencySystem, domAPI, browserService, eventHandlers,\n        domReadinessService, logger, APP_CONFIG, safeHandler,\n        sanitizer, createProjectDetailsEnhancements,\n        createTokenStatsManager, createKnowledgeBaseComponent,\n        uiUtils\n    } = deps;\n\n    if (!DependencySystem || !domAPI || !browserService || !eventHandlers ||\n        !domReadinessService || !logger || !APP_CONFIG || !safeHandler ||\n        !sanitizer || !createProjectDetailsEnhancements ||\n        !createTokenStatsManager || !createKnowledgeBaseComponent ||\n        !domReadinessService || !uiUtils) {\n        throw new Error('[uiInit] Missing required dependencies for UI initialization.');\n    }\n\n    let _uiInitialized = false;\n\n    async function setupSidebarControls() {\n        logger.log('[UIInit] setupSidebarControls: no-op (handled by Sidebar module)', {\n            context: 'uiInit:setupSidebarControls'\n        });\n    }\n\n    async function loadProjectTemplates() {\n        const htmlLoader = DependencySystem.modules.get('htmlTemplateLoader');\n        if (!htmlLoader?.loadTemplate) {\n            logger.error('[UIInit] htmlTemplateLoader.loadTemplate unavailable', {\n                context: 'uiInit:loadTemplates'\n            });\n            return;\n        }\n\n        try {\n            logger.log('[UIInit] Loading project templates', {\n                context: 'uiInit:loadTemplates'\n            });\n\n            await htmlLoader.loadTemplate({\n                url: '/static/html/project_list.html',\n                containerSelector: '#projectListView',\n                eventName: 'projectListHtmlLoaded'\n            });\n\n            await htmlLoader.loadTemplate({\n                url: '/static/html/project_details.html',\n                containerSelector: '#projectDetailsView',\n                eventName: 'projectDetailsHtmlLoaded'\n            });\n\n            await htmlLoader.loadTemplate({\n                url: '/static/html/modals.html',\n                containerSelector: '#modalsContainer',\n                eventName: 'modalsHtmlLoaded'\n            });\n\n            logger.log('[UIInit] Project templates loaded', {\n                context: 'uiInit:loadTemplates'\n            });\n        } catch (err) {\n            logger.error('[UIInit] Failed to load project templates', err, {\n                context: 'uiInit:loadTemplates'\n            });\n            throw err;\n        }\n    }\n\n    async function waitForModalReadiness() {\n        const modalMgr = DependencySystem.modules.get('modalManager');\n        if (!modalMgr?.isReadyPromise) {\n            throw new Error('[uiInit] ModalManager or isReadyPromise not available.');\n        }\n\n        const timeoutMS = 8000;\n        let timedOut = false;\n\n        await Promise.race([\n            modalMgr.isReadyPromise(),\n            new Promise((_, reject) =>\n                browserService.getWindow().setTimeout(() => {\n                    timedOut = true;\n                    reject(new Error(`[uiInit] Modal readiness timeout after ${timeoutMS}ms.`));\n                }, timeoutMS)\n            )\n        ]);\n\n        if (timedOut) {\n            throw new Error('[uiInit] ModalManager not ready within timeout.');\n        }\n    }\n\n    function ensureBaseProjectContainers() {\n        logger.info('[uiInit] ensureBaseProjectContainers ENTER', { context: 'uiInit:ensureBaseProjectContainers' });\n\n        try {\n            const doc = domAPI.getDocument?.();\n            if (!doc) {\n                logger.error('[uiInit] No document available', { context: 'uiInit:ensureBaseProjectContainers' });\n                return;\n            }\n\n            const panel = domAPI.querySelector('#projectManagerPanel') || doc.body;\n            if (!panel) {\n                logger.error('[uiInit] No target panel', { context: 'uiInit:ensureBaseProjectContainers' });\n                return;\n            }\n\n            let listFound = !!domAPI.querySelector('#projectListView');\n            let detailsFound = !!domAPI.querySelector('#projectDetailsView');\n\n            if (!listFound) {\n                const list = domAPI.createElement('div');\n                list.id = 'projectListView';\n                list.className = 'project-list-view';\n                list.dataset.dynamic = 'true';\n                domAPI.appendChild(panel, list);\n                logger.info('[uiInit] #projectListView dynamically inserted', { context: 'uiInit:ensureBaseProjectContainers' });\n            }\n\n            if (!detailsFound) {\n                const details = domAPI.createElement('div');\n                details.id = 'projectDetailsView';\n                details.className = 'project-details-view hidden';\n                details.dataset.dynamic = 'true';\n                domAPI.appendChild(panel, details);\n                logger.info('[uiInit] #projectDetailsView dynamically inserted', { context: 'uiInit:ensureBaseProjectContainers' });\n            }\n        } catch (err) {\n            logger.error('[uiInit] ensureBaseProjectContainers failed', err, {\n                context: 'uiInit:ensureBaseProjectContainers'\n            });\n        }\n    }\n\n    async function createAndRegisterUIComponents() {\n        logger.log('[UIInit] Creating late-stage UI components', {\n            context: 'uiInit:createAndRegisterUIComponents'\n        });\n\n        // Project Details Enhancements\n        if (createProjectDetailsEnhancements) {\n            const inst = createProjectDetailsEnhancements({\n                domAPI, browserService, eventHandlers,\n                domReadinessService, logger, sanitizer,\n                DependencySystem\n            });\n            DependencySystem.register('projectDetailsEnhancements', inst);\n\n            if (inst.initialize) {\n                await inst.initialize().catch(err =>\n                    logger.error('[UIInit] ProjectDetailsEnhancements init failed', err, {\n                        context: 'uiInit:projectDetailsEnhancements'\n                    })\n                );\n            }\n        }\n\n        // Token Stats Manager\n        if (createTokenStatsManager) {\n            const inst = createTokenStatsManager({\n                apiClient: DependencySystem.modules.get('apiRequest'),\n                domAPI, eventHandlers, browserService,\n                modalManager: DependencySystem.modules.get('modalManager'),\n                sanitizer, logger,\n                safeHandler: DependencySystem.modules.get('safeHandler'),\n                projectManager: DependencySystem.modules.get('projectManager'),\n                app: DependencySystem.modules.get('appModule'),\n                chatManager: DependencySystem.modules.get('chatManager'),\n                domReadinessService, DependencySystem\n            });\n\n            // Replace proxy with real instance\n            const proxy = DependencySystem.modules.get('tokenStatsManagerProxy');\n            if (proxy && proxy.__isProxy && typeof proxy.setRealManager === 'function') {\n                proxy.setRealManager(inst);\n                DependencySystem.modules.delete('tokenStatsManager');\n                DependencySystem.register('tokenStatsManager', inst);\n            } else {\n                DependencySystem.register('tokenStatsManager', inst);\n            }\n\n            if (typeof inst.initialize === 'function') {\n                await inst.initialize().catch(err =>\n                    logger.error('[UIInit] TokenStatsManager init failed', err, {\n                        context: 'uiInit:tokenStatsManager'\n                    })\n                );\n            }\n        }\n\n        // Wire up ProjectDashboard dependencies\n        const pdDashboard = DependencySystem.modules.get('projectDashboard');\n        const pdc = DependencySystem.modules.get('projectDetailsComponent');\n        const plc = DependencySystem.modules.get('projectListComponent');\n\n        if (pdDashboard) {\n            if (pdc && typeof pdDashboard.setProjectDetailsComponent === 'function') {\n                pdDashboard.setProjectDetailsComponent(pdc);\n            }\n            if (plc && typeof pdDashboard.setProjectListComponent === 'function') {\n                pdDashboard.setProjectListComponent(plc);\n            }\n\n            if (typeof pdDashboard.initialize === 'function' && !pdDashboard.__initialized) {\n                try {\n                    await domReadinessService.waitForEvent('authReady', { timeout: 30000 });\n                    if (!pdDashboard.__initialized) {\n                        await pdDashboard.initialize();\n                        pdDashboard.__initialized = true;\n                    }\n                } catch (err) {\n                    logger.error('[UIInit] ProjectDashboard.initialize failed', err, {\n                        context: 'uiInit:projectDashboardInit'\n                    });\n                }\n            }\n        }\n\n        logger.log('[UIInit] Late-stage UI components registered', {\n            context: 'uiInit:createAndRegisterUIComponents'\n        });\n    }\n\n    async function registerNavigationViews() {\n        const navSvc = DependencySystem.modules.get('navigationService');\n        if (!navSvc || typeof navSvc.registerView !== 'function') {\n            throw new Error('[uiInit] NavigationService missing registerView');\n        }\n\n        try {\n            // Register project list view\n            if (!navSvc.hasView('projectList')) {\n                navSvc.registerView('projectList', {\n                    show: async () => {\n                        const dash = DependencySystem.modules.get('projectDashboard');\n                        if (dash?.components?.projectList?.show) {\n                            await dash.components.projectList.show();\n                            return true;\n                        }\n                        const plc = DependencySystem.modules.get('projectListComponent');\n                        if (plc?.show) {\n                            await plc.show();\n                            return true;\n                        }\n                        throw new Error('[uiInit] Cannot show projectList');\n                    },\n                    hide: async () => {\n                        const dash = DependencySystem.modules.get('projectDashboard');\n                        if (dash?.components?.projectList?.hide) {\n                            await dash.components.projectList.hide();\n                            return true;\n                        }\n                        const plc = DependencySystem.modules.get('projectListComponent');\n                        if (plc?.hide) {\n                            await plc.hide();\n                            return true;\n                        }\n                        throw new Error('[uiInit] Cannot hide projectList');\n                    }\n                });\n            }\n\n            // Register project details view\n            if (!navSvc.hasView('projectDetails')) {\n                navSvc.registerView('projectDetails', {\n                    show: async ({ projectId }) => {\n                        await domReadinessService.dependenciesAndElements({\n                            deps: ['projectDashboard', 'projectDetailsComponent'],\n                            timeout: 10000,\n                            context: 'uiInit:nav:projectDetails'\n                        });\n\n                        const dash = DependencySystem.modules.get('projectDashboard');\n                        if (dash?.showProjectDetails) {\n                            await dash.showProjectDetails(projectId);\n\n                            // Initialize KnowledgeBaseComponent if needed\n                            const kbComp = DependencySystem.modules.get('knowledgeBaseComponent');\n                            if (kbComp && (!kbComp.isInitialized || kbComp.isInitialized() === false) && typeof kbComp.initialize === 'function') {\n                                try {\n                                    await kbComp.initialize(true, null, projectId);\n                                    logger.debug('[uiInit] KnowledgeBaseComponent initialized', { context: 'uiInit' });\n                                } catch (err) {\n                                    logger.error('[uiInit] KnowledgeBaseComponent initialization failed', err, { context: 'uiInit' });\n                                }\n                            }\n                            return true;\n                        }\n                        throw new Error('[uiInit] Cannot show projectDetails');\n                    },\n                    hide: async () => {\n                        const dash = DependencySystem.modules.get('projectDashboard');\n                        if (dash?.components?.projectDetails?.hideProjectDetails) {\n                            await dash.components.projectDetails.hideProjectDetails();\n                            return true;\n                        }\n                        const pdc = DependencySystem.modules.get('projectDetailsComponent');\n                        if (pdc?.hideProjectDetails) {\n                            await pdc.hideProjectDetails();\n                            return true;\n                        }\n                        throw new Error('[uiInit] Cannot hide projectDetails');\n                    }\n                });\n            }\n\n            logger.log('[UIInit] Navigation views registered', { context: 'uiInit:navigation' });\n        } catch (err) {\n            logger.error('[uiInit] Failed to register navigation views', err, {\n                context: 'uiInit:registerNavigationViews'\n            });\n        }\n    }\n\n    async function initializeUIComponents() {\n        if (_uiInitialized) {\n            logger.debug('[uiInit] UI already initialized; skipping', {\n                context: 'uiInit:initializeUIComponents'\n            });\n            return;\n        }\n\n        try {\n            logger.log('[uiInit] Starting UI initialization...', { context: 'uiInit' });\n\n            // Create base containers first\n            ensureBaseProjectContainers();\n\n            // Load templates into containers\n            await loadProjectTemplates();\n\n            // Wait for DOM elements\n            await domReadinessService.dependenciesAndElements({\n                domSelectors: ['#projectListView', '#projectDetailsView'],\n                timeout: 10000,\n                context: 'uiInit:initializeUIComponents:baseDomCheck'\n            });\n\n            await domReadinessService.dependenciesAndElements({\n                domSelectors: ['#projectCardsPanel', '#projectFilterTabs'],\n                observeMutations: true,\n                timeout: APP_CONFIG?.TIMEOUTS?.PROJECT_LIST_ELEMENTS ?? 15000,\n                context: 'uiInit:initializeUIComponents:projectListInnerSelectors'\n            });\n\n            await setupSidebarControls();\n            await waitForModalReadiness();\n\n            // Initialize event handlers\n            if (eventHandlers.init) {\n                await eventHandlers.init();\n                logger.log('[uiInit] eventHandlers init complete', { context: 'uiInit' });\n            }\n\n            // Emit early readiness events\n            try {\n                domReadinessService.emitReplayable('app:ready');\n                const appModule = DependencySystem.modules.get('appModule');\n                appModule.setAppLifecycleState({ isReady: true, currentPhase: 'ui_ready_partial' });\n            } catch (earlyEmitErr) {\n                logger.warn('[uiInit] Early app:ready emit failed', earlyEmitErr, {\n                    context: 'uiInit:earlyAppReady'\n                });\n            }\n\n            domReadinessService.emitReplayable('ui:templates:ready');\n            await createAndRegisterUIComponents();\n            await registerNavigationViews();\n\n            logger.log('[uiInit] UI initialization complete', {\n                context: 'uiInit:initializeUIComponents'\n            });\n\n            // Initialize remaining components\n            const plc = DependencySystem.modules.get('projectListComponent');\n            if (plc?.initialize) {\n                try {\n                    await plc.initialize();\n                } catch (e) {\n                    logger.error('[uiInit] projectListComponent.initialize failed', e, { context: 'uiInit' });\n                }\n            }\n\n            const sidebar = DependencySystem.modules.get('sidebar');\n            if (sidebar?.init) {\n                try {\n                    await sidebar.init();\n                    logger.info('[uiInit] sidebar.init completed', { context: 'uiInit' });\n\n                    // Initialize mobile dock\n                    const mobileDock = sidebar.getMobileDock?.();\n                    if (mobileDock?.init) {\n                        await mobileDock.init();\n                        mobileDock.ensureMobileDock?.();\n                        logger.debug('[uiInit] Mobile dock initialised', { context: 'uiInit' });\n                    }\n\n                    // Initialize sidebar auth\n                    const sidebarAuth = sidebar.getSidebarAuth?.();\n                    if (sidebarAuth?.init) {\n                        await sidebarAuth.init();\n                        sidebarAuth.setupInlineAuthForm?.();\n\n                        if (typeof sidebarAuth.forceAuthStateSync === 'function') {\n                            try {\n                                sidebarAuth.forceAuthStateSync();\n                            } catch (syncErr) {\n                                logger.warn('[uiInit] sidebarAuth.forceAuthStateSync threw', syncErr, { context: 'uiInit' });\n                            }\n                        }\n\n                        logger.debug('[uiInit] SidebarAuth initialised', { context: 'uiInit' });\n                    }\n                } catch (err) {\n                    logger.error('[uiInit] sidebar.init failed', err, { context: 'uiInit' });\n                }\n            }\n\n            const a11yUtils = DependencySystem.modules.get('accessibilityUtils');\n            if (a11yUtils?.init) {\n                try {\n                    await a11yUtils.init();\n                    logger.debug('[uiInit] AccessibilityUtils initialised', { context: 'uiInit' });\n                } catch (err) {\n                    logger.error('[uiInit] AccessibilityUtils.init failed', err, { context: 'uiInit' });\n                }\n            }\n\n            _uiInitialized = true;\n        } catch (err) {\n            logger.error('[uiInit] Critical error in UI init', err, {\n                context: 'uiInit:initializeUIComponents'\n            });\n            throw err;\n        }\n    }\n\n    function cleanup() {\n        eventHandlers.cleanupListeners({ context: 'uiInit' });\n        logger.debug('[uiInit] Cleanup completed', { context: 'uiInit:cleanup' });\n    }\n\n    return {\n        initializeUIComponents,\n        waitForModalReadinessWithTimeout: async (timeout = 8000, context = 'waitForModalReadiness') => {\n            await waitForModalReadiness();\n            return true;\n        },\n        registerNavigationViews,\n        cleanup\n    };\n}\n"],"mappings":"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","ignoreList":[]}