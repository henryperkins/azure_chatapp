<nav id="mainSidebar"
     aria-labelledby="sidebarHeading"
     aria-hidden="true"
     class="fixed md:relative inset-y-0 left-0 z-50
            w-64 md:w-72 bg-base-100 shadow-xl
            md:shadow-none border-r border-base-300
            transform transition-transform
            duration-300 ease-in-out -translate-x-full
            md:translate-x-0 overflow-y-auto h-full
            sidebar focus-within:ring-2
            focus-within:ring-primary
            focus-within:outline-none">
  <h2 id="sidebarHeading" class="sr-only">Site Navigation</h2>

  <button id="closeSidebarBtn"
          type="button"
          class="md:hidden absolute top-3 right-3
                 btn btn-ghost btn-sm btn-circle
                 focus-visible:outline-none focus-visible:ring-2
                 focus-visible:ring-primary"
          aria-label="Close sidebar" tabindex="0"
          onclick="document.getElementById('mainSidebar').classList.add('-translate-x-full');">
    <svg aria-hidden="true"
         xmlns="http://www.w3.org/2000/svg"
         class="h-5 w-5"
         fill="none"
         viewBox="0 0 24 24"
         stroke="currentColor">
      <path stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12" />
    </svg>
  </button>

  <div class="p-4 pb-6 flex flex-col h-full min-h-0">
    <!-- Example top-level action -->
    <a href="{{ url_for('index') }}"
       class="w-full btn btn-primary mb-4 flex items-center justify-center gap-2"
       role="button">
      <svg xmlns="http://www.w3.org/2000/svg"
           class="h-4 w-4"
           fill="none" viewBox="0 0 24 24"
           stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M8 12h.01M12
                 12h.01M16
                 12h.01M21
                 12c0
                 4.418-4.03
                 8-9
                 8a9.863
                 9.863
                 0
                 01-4.255-.949L3
                 20l1.395-3.72C3.512
                 15.042
                 3
                 13.574
                 3
                 12c0-4.418
                 4.03-8
                 9-8s9
                 3.582
                 9
                 8z" />
      </svg>
      Back to Chat
    </a>

    <!-- Tabs for Recent/Starred/Projects -->
    <div class="enhanced-tabs mb-4 overflow-x-auto no-scrollbar" role="tablist">
      <button id="recentChatsTab"
              type="button"
              class="enhanced-tab"
              role="tab"
              aria-selected="false"
              aria-controls="recentChatsSection"
              tabindex="-1"
              onclick="
                document.getElementById('recentChatsSection').classList.remove('hidden');
                document.getElementById('starredChatsSection').classList.add('hidden');
                document.getElementById('projectsSection').classList.add('hidden');
              ">
        <span class="flex items-center gap-1">
          <svg xmlns="http://www.w3.org/2000/svg"
               class="h-4 w-4"
               fill="none" viewBox="0 0 24 24"
               stroke="currentColor"
               aria-hidden="true">
            <path stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 8v4l3
                     3m6-3a9
                     9
                     0
                     11-18
                     0
                     9
                     9
                     0
                     0118
                     0z" />
          </svg>
          Recent
        </span>
      </button>
      <button id="starredChatsTab"
              type="button"
              class="enhanced-tab"
              role="tab"
              aria-selected="false"
              aria-controls="starredChatsSection"
              tabindex="-1"
              onclick="
                document.getElementById('recentChatsSection').classList.add('hidden');
                document.getElementById('starredChatsSection').classList.remove('hidden');
                document.getElementById('projectsSection').classList.add('hidden');
              ">
        <span class="flex items-center gap-1">
          <svg xmlns="http://www.w3.org/2000/svg"
               class="h-4 w-4"
               fill="none"
               viewBox="0 0 24 24"
               stroke="currentColor"
               aria-hidden="true">
            <path stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M11.049
                     2.927c.3-.921
                     1.603-.921
                     1.902
                     0l1.519
                     4.674a1
                     1
                     0
                     00.95.69h4.915c.969
                     0
                     1.371
                     1.24.588
                     1.81l-3.976
                     2.888a1
                     1
                     0
                     00-.363
                     1.118l1.518
                     4.674c.3.922-.755
                     1.688-1.538
                     1.118l-3.976-2.888a1
                     1
                     0
                     00-1.176
                     0l-3.976
                     2.888c-.783.57-1.838-.197-1.538-1.118l
                     1.518-4.674a1
                     1
                     0
                     00-.363-1.118l-3.976-2.888c-.783-.57-.38-1.81.588-1.81h
                     4.914a1
                     1
                     0
                     00.951-.69l1.519-4.674z" />
          </svg>
          Starred
        </span>
      </button>
      <button id="projectsTab"
              type="button"
              class="enhanced-tab tab-active"
              role="tab"
              aria-selected="true"
              aria-controls="projectsSection"
              tabindex="0"
              onclick="
                document.getElementById('recentChatsSection').classList.add('hidden');
                document.getElementById('starredChatsSection').classList.add('hidden');
                document.getElementById('projectsSection').classList.remove('hidden');
              ">
        <span class="flex items-center gap-1">
          <svg xmlns="http://www.w3.org/2000/svg"
               class="h-4 w-4"
               fill="none"
               viewBox="0 0 24 24"
               stroke="currentColor" aria-hidden="true">
            <path stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3
                     7v10a2
                     2
                     0
                     002
                     2h14a2
                     2
                     0
                     002-2V9a2
                     2
                     0
                     00-2-2h-6l-2-2H5a2
                     2
                     0
                     00-2
                     2z" />
          </svg>
          Projects
        </span>
      </button>
    </div>

    <!-- Recent Chats Section -->
    <div id="recentChatsSection"
         class="hidden flex-1 flex-col min-h-0 overflow-hidden bg-base-200 rounded-box shadow-sm p-3"
         role="tabpanel"
         aria-labelledby="recentChatsTab"
         tabindex="0">
      <div class="form-control-enhanced mb-3">
        <div class="join w-full">
          <div class="relative flex-grow join-item">
            <label for="chatSearchInput" class="sr-only">Search</label>
            <input type="search"
                   aria-label="Search conversations"
                   id="chatSearchInput"
                   placeholder="Search conversations..."
                   class="input input-bordered w-full pl-8 pr-2 py-1 text-sm" />
            <svg xmlns="http://www.w3.org/2000/svg"
                 class="h-4 w-4 absolute left-2 top-1/2 -translate-y-1/2 text-base-content/40 pointer-events-none"
                 aria-hidden="true" fill="none" viewBox="0 0 24 24"
                 stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M21
                       21l-6-6m2-5a7
                       7
                       0
                       11-14
                       0
                       7
                       7
                       0
                       0114
                       0z" />
            </svg>
          </div>
          <button id="pinSidebarBtn"
                  type="button"
                  class="btn btn-square btn-sm join-item"
                  title="Pin sidebar open"
                  aria-label="Pin sidebar">
            <svg xmlns="http://www.w3.org/2000/svg"
                 class="h-4 w-4"
                 fill="none"
                 viewBox="0 0 24 24"
                 stroke="currentColor"
                 aria-hidden="true">
              <path stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M5
                       5a2
                       2
                       0
                       012-2h10a2
                       2
                       0
                       012
                       2v16l-7-3.5L5
                       21V5z" />
            </svg>
          </button>
        </div>
        <kbd class="kbd-shortcut text-xs mt-1 text-base-content/70 hidden sm:flex">
          <kbd class="kbd kbd-xs">s</kbd>
          <span class="mx-1">to search</span>
        </kbd>
      </div>
      <ul id="sidebarConversations"
          class="overflow-y-auto flex-1 gap-y-2 text-sm pr-1 menu menu-vertical"
          role="list">
        <li class="text-center text-base-content/60 py-4">
          No conversations yet.
        </li>
      </ul>
    </div>

    <!-- Starred Chats Section -->
    <div id="starredChatsSection"
         class="hidden flex-1 flex-col min-h-0 overflow-hidden bg-base-200 rounded-box shadow-sm p-3"
         role="tabpanel"
         aria-labelledby="starredChatsTab"
         tabindex="0">
      <div class="alert alert-info shadow-xs mb-2">
        <svg xmlns="http://www.w3.org/2000/svg"
             fill="none" viewBox="0 0 24 24"
             class="stroke-info shrink-0 w-5 h-5" aria-hidden="true">
          <path stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M13
                   16h-1v-4h-1m1-4h.01M21
                   12a9
                   9
                   0
                   11-18
                   0
                   9
                   9
                   0
                   0118
                   0z" />
        </svg>
        <div class="text-xs">
          Star important conversations for quick access.
        </div>
      </div>
      <ul id="starredConversations"
          class="overflow-y-auto flex-1 gap-y-2 text-sm menu menu-vertical"
          role="list">
        <li class="text-center text-base-content/60 py-4">
          No starred conversations yet.
        </li>
      </ul>
    </div>

    <!-- Projects Section -->
    <div id="projectsSection"
         class="flex-1 flex flex-col min-h-0 overflow-hidden bg-base-200 rounded-box shadow-sm p-3"
         role="tabpanel"
         aria-labelledby="projectsTab"
         tabindex="0">
      <div class="join mb-3 w-full">
        <a id="manageProjectsLink"
           href="{{ url_for('project_list') }}"
           class="btn btn-sm btn-outline join-item flex-1 flex gap-1"
           tabindex="0">
          <svg xmlns="http://www.w3.org/2000/svg"
               class="h-4 w-4"
               fill="none"
               viewBox="0 0 24 24"
               stroke="currentColor"
               aria-hidden="true">
            <path stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4
                     6h16M4
                     12h16M4
                     18h7" />
          </svg>
          Manage
        </a>
        <button id="sidebarNewProjectBtn"
                type="button"
                class="btn btn-sm btn-primary join-item flex-1 flex gap-1"
                tabindex="0"
                onclick="document.getElementById('projectModal').showModal();">
          <svg xmlns="http://www.w3.org/2000/svg"
               class="h-4 w-4"
               fill="none"
               viewBox="0 0 24 24"
               stroke="currentColor"
               aria-hidden="true">
            <path stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 6v6m0
                     0v6m0-6h6m-6
                     0H6" />
          </svg>
          New Project
        </button>
      </div>

      <div class="form-control-enhanced mb-3">
        <div class="relative">
          <label for="sidebarProjectSearch" class="sr-only">Search projects</label>
          <input type="search"
                 id="sidebarProjectSearch"
                 aria-label="Search projects"
                 placeholder="Search projects..."
                 class="input input-bordered w-full pl-8 pr-2 py-2 text-sm" />
          <svg xmlns="http://www.w3.org/2000/svg"
               class="h-4 w-4 absolute left-2 top-1/2 -translate-y-1/2
                      text-base-content/40 pointer-events-none"
               aria-hidden="true" fill="none" viewBox="0 0 24 24"
               stroke="currentColor">
            <path stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21
                     21l-6-6m2-5a7
                     7
                     0
                     11-14
                     0
                     7
                     7
                     0
                     0114
                     0z" />
          </svg>
        </div>
        <kbd class="kbd-shortcut text-xs mt-1 text-base-content/70 hidden sm:flex">
          <kbd class="kbd kbd-xs">s</kbd>
          <span class="mx-1">to search</span>
        </kbd>
      </div>

      <ul id="sidebarProjects"
          class="menu menu-vertical overflow-y-auto flex-1 gap-y-2 text-sm sidebar-nav"
          role="list">
        <li class="text-center text-base-content/60 py-4">
          No projects yet.
        </li>
      </ul>
    </div>
  </div>
</nav>
