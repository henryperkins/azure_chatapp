<!-- All shared modals in one file -->

<!-- Project Creation/Edit Modal -->
<dialog id="projectModal" class="modal modal-bottom sm:modal-middle" role="dialog" aria-modal="true" aria-labelledby="projectModalTitle">
  <div class="modal-box max-w-2xl">
    <div class="flex justify-between items-center mb-6">
      <h3 id="projectModalTitle" class="text-2xl font-bold">Create New Project</h3>
      <button id="projectModalCloseBtn" type="button" class="btn btn-ghost btn-sm btn-square" aria-label="Close dialog"
              onclick="document.getElementById('projectModal').close();">
        <svg xmlns="http://www.w3.org/2000/svg"
             class="h-6 w-6"
             fill="none" viewBox="0 0 24 24"
             stroke="currentColor" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M6 18L18
                   6M6 6l12 12" />
        </svg>
      </button>
    </div>
    <form id="projectModalForm" action="#" method="POST">
      <input type="hidden" id="projectModalIdInput" name="projectId" value="" />
      <div class="form-control-enhanced">
        <label for="projectModalNameInput" class="label">
          <span class="label-text font-medium">Project Name <span class="text-error">*</span></span>
        </label>
        <input id="projectModalNameInput"
               name="name"
               type="text"
               required
               aria-required="true"
               autocomplete="off"
               class="input input-bordered w-full validator"
               aria-describedby="projectModalNameInput-hint" />
        <p id="projectModalNameInput-hint" class="validator-hint hidden" role="alert"></p>
      </div>
      <div class="form-control-enhanced mt-2">
        <label for="projectModalDescInput" class="label">
          <span class="label-text font-medium">Description</span>
        </label>
        <textarea id="projectModalDescInput"
                  name="description"
                  rows="3"
                  placeholder="Short summary of this project's purpose"
                  class="textarea textarea-bordered w-full"></textarea>
      </div>
      <div class="form-control-enhanced mt-2">
        <label for="projectModalMaxTokensInput" class="label">
          <span class="label-text font-medium">Max Tokens</span>
        </label>
        <input id="projectModalMaxTokensInput"
               name="maxTokens"
               type="number"
               value="200000"
               min="50000"
               max="500000"
               class="input input-bordered w-full validator" />
      </div>
      <div class="modal-action mt-4">
        <kbd class="kbd-shortcut hidden md:inline-flex mr-auto">
          <kbd class="kbd kbd-sm">Esc</kbd>
          <span class="mx-1">to cancel</span>
        </kbd>
        <button type="button" class="btn btn-ghost"
                aria-label="Cancel and close dialog"
                onclick="document.getElementById('projectModal').close();">
          Cancel
        </button>
        <button type="submit" id="projectSaveBtn" class="btn btn-primary">
          Save Project
        </button>
      </div>
    </form>
  </div>
  <form method="dialog" class="modal-backdrop">
    <button>close</button>
  </form>
</dialog>

<!-- Instructions Modal -->
<div id="instructionsModal" class="modal hidden">
  <div class="modal-box max-w-lg w-full max-h-[90vh] overflow-y-auto">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-xl font-semibold">Custom Instructions</h3>
      <button id="closeInstructionsBtn"
              type="button"
              class="btn btn-ghost btn-sm btn-square"
              onclick="document.getElementById('instructionsModal').classList.add('hidden');">
        <svg xmlns="http://www.w3.org/2000/svg"
             class="h-6 w-6"
             fill="none"
             viewBox="0 0 24 24"
             stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
    <div class="mb-4">
      <p class="text-sm text-base-content/80 mb-2">
        Custom instructions are sent at the beginning of every conversation in this project.
      </p>
      <textarea id="customInstructionsInput"
                rows="8"
                class="w-full px-3 py-2 border border-base-300
                       rounded-lg shadow-xs focus:outline-hidden
                       focus:ring-primary focus:border-primary h-20"
                placeholder="Enter global instructions..."></textarea>
    </div>
    <div class="flex justify-end gap-2">
      <button id="cancelInstructionsBtn" type="button" class="btn btn-outline"
              onclick="document.getElementById('instructionsModal').classList.add('hidden');">
        Cancel
      </button>
      <button id="saveInstructionsBtn" type="button" class="btn btn-primary">
        Save Instructions
      </button>
    </div>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<dialog id="deleteConfirmModal" class="modal">
  <div class="modal-box max-w-md w-full">
    <h3 class="text-xl font-semibold mb-4">Confirm Delete</h3>
    <p id="deleteConfirmText" class="mb-6">
      Are you sure you want to delete this item?
    </p>
    <div class="flex justify-end gap-2">
      <button id="cancelDeleteBtn" type="button" class="btn btn-outline"
              onclick="document.getElementById('deleteConfirmModal').close();">
        Cancel
      </button>
      <button id="confirmDeleteBtn" type="button" class="btn btn-error">
        Delete
      </button>
    </div>
  </div>
</dialog>

<!-- Generic Confirm Action Modal -->
<dialog id="confirmActionModal" class="modal">
  <div class="modal-box max-w-md w-full">
    <form method="dialog">
      <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">âœ•</button>
    </form>
    <h3 class="font-bold text-lg">Confirm Action</h3>
    <p class="py-4">Are you sure you want to proceed?</p>
    <div class="modal-action">
      <button id="cancelActionBtn" type="button" class="btn btn-outline"
              onclick="document.getElementById('confirmActionModal').close();">
        Cancel
      </button>
      <button id="confirmActionBtn" type="button" class="btn btn-primary">
        Confirm
      </button>
    </div>
  </div>
  <form method="dialog" class="modal-backdrop">
    <button>close</button>
  </form>
</dialog>

<!-- Content View Modal -->
<div id="contentViewModal" class="modal hidden">
  <div class="modal-box max-w-4xl w-full max-h-[90vh] overflow-y-auto">
    <div class="flex justify-between items-center mb-4">
      <h3 id="contentViewModalTitle" class="text-xl font-semibold">File Content</h3>
      <button id="closeContentViewModalBtn" type="button"
              class="btn btn-ghost btn-sm btn-square"
              onclick="document.getElementById('contentViewModal').classList.add('hidden');">
        <svg xmlns="http://www.w3.org/2000/svg"
             class="h-6 w-6"
             fill="none"
             viewBox="0 0 24 24"
             stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M6
                   18L18
                   6M6
                   6l12
                   12" />
        </svg>
      </button>
    </div>
    <div id="contentViewModalContent">
      <!-- Insert dynamic file preview here -->
    </div>
  </div>
</div>

<!-- Knowledge Base Settings Modal (optional) -->
<dialog id="knowledgeBaseSettingsModal" class="modal">
  <div class="modal-box max-w-lg w-full">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-xl font-semibold">Knowledge Base Settings</h3>
      <button id="closeKnowledgeSettingsBtn" type="button"
              class="btn btn-ghost btn-sm btn-square"
              aria-label="Close dialog"
              onclick="document.getElementById('knowledgeBaseSettingsModal').close();">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6"
             fill="none" viewBox="0 0 24 24"
             stroke="currentColor" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M6 18L18
                   6M6 6l12
                   12" />
        </svg>
      </button>
    </div>
    <form id="knowledgeBaseForm">
      <div class="form-control-enhanced">
        <label for="knowledgeBaseNameInput" class="block text-sm font-medium text-base-content">
          KB Name <span class="text-error">*</span>
        </label>
        <input id="knowledgeBaseNameInput"
               name="name"
               type="text"
               required
               aria-required="true"
               class="input input-bordered w-full" />
      </div>
      <div class="form-control-enhanced mt-2">
        <label for="knowledgeBaseDescInput" class="block text-sm font-medium text-base-content">
          Description
        </label>
        <textarea id="knowledgeBaseDescInput"
                  name="description"
                  rows="3"
                  class="textarea textarea-bordered w-full"></textarea>
      </div>
      <div class="modal-action mt-4">
        <kbd class="kbd-shortcut hidden md:inline-flex mr-auto">
          <kbd class="kbd kbd-sm">Esc</kbd>
          <span class="mx-1">to cancel</span>
        </kbd>
        <button type="button" class="btn btn-outline"
                onclick="document.getElementById('knowledgeBaseSettingsModal').close();">
          Cancel
        </button>
        <button type="submit" id="submitKnowledgeBaseFormBtn" class="btn btn-primary">
          Save Settings
        </button>
      </div>
    </form>
  </div>
  <form method="dialog" class="modal-backdrop">
    <button>close</button>
  </form>
</dialog>

<!-- Knowledge Result Detail Modal -->
<dialog id="knowledgeResultModal" class="modal">
  <div class="modal-box max-w-4xl w-full max-h-[90vh] overflow-y-auto">
    <div class="flex justify-between items-center mb-4">
      <h3 id="knowledgeResultTitle" class="text-xl font-semibold">Knowledge Result</h3>
      <button id="closeKnowledgeResultBtn"
              type="button"
              class="btn btn-ghost btn-sm btn-square"
              aria-label="Close dialog"
              onclick="document.getElementById('knowledgeResultModal').close();">
        <svg xmlns="http://www.w3.org/2000/svg"
             class="h-6 w-6"
             fill="none" viewBox="0 0 24 24"
             stroke="currentColor"
             aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M6
                   18L18
                   6M6
                   6l12
                   12" />
        </svg>
      </button>
    </div>
    <div class="card card-compact bg-base-200 shadow-sm mb-4 p-3">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
        <div class="flex items-center gap-2">
          <div class="badge badge-neutral">Source</div>
          <div id="knowledgeResultSource" class="text-sm font-medium truncate">Filename</div>
        </div>
        <div class="flex items-center gap-2">
          <div class="badge badge-neutral">Relevance</div>
          <div id="knowledgeResultScore" class="badge badge-lg kb-result-relevance-high">100%</div>
        </div>
      </div>
    </div>
    <div class="bg-base-100 border border-base-300 p-4 rounded-box overflow-x-auto mb-4">
      <pre id="knowledgeResultContent" class="whitespace-pre-wrap text-sm"></pre>
    </div>
    <div class="modal-action">
      <button id="copyContentBtn" type="button" class="btn btn-outline btn-sm">Copy</button>
      <button id="useInChatBtn" type="button" class="btn btn-primary btn-sm">Use in Conversation</button>
    </div>
  </div>
</dialog>
