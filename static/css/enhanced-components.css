/* =============================================================================
   enhanced-components.css
   =============================================================================
   Enhanced Components CSS for Azure Chat Application
   Tailwind CSS v4 + DaisyUI 5
*/

/* Do NOT "@import 'tailwindcss';" here. This file is included by tailwind.css. */

/* Enhanced Dracula theme with better contrast ratios for accessibility */
@plugin "daisyui/theme" {
  name: dracula-enhanced;
  default: false;
  prefersdark: true;
  color-scheme: dark;

  /* Enhanced base colors with slightly better contrast */
  --color-base-100: oklch(28.8% 0.025 277.5);
  --color-base-200: oklch(25.8% 0.023 277.5);
  --color-base-300: oklch(22.8% 0.021 277.5);
  --color-base-content: oklch(98% 0.01 106.5);

  /* Vibrant primary (pink) */
  --color-primary: oklch(76% 0.19 346.8);
  --color-primary-content: oklch(15% 0.036 346.8);
  --color-primary-focus: oklch(78% 0.21 346.8);

  /* Enhanced secondary (purple) */
  --color-secondary: oklch(75% 0.155 301.9);
  --color-secondary-content: oklch(15% 0.03 301.9);
  --color-secondary-focus: oklch(77% 0.17 301.9);

  /* Brightened accent (yellow) */
  --color-accent: oklch(84% 0.13 66.6);
  --color-accent-content: oklch(16.7% 0.024 66.6);
  --color-accent-focus: oklch(86% 0.14 66.6);

  /* Other UI colors */
  --color-neutral: oklch(39.5% 0.035 275.5);
  --color-neutral-content: oklch(88% 0.01 275.5);

  /* Enhanced status colors */
  --color-info: oklch(88.3% 0.1 212.8);
  --color-info-content: oklch(17.7% 0.02 212.8);

  --color-success: oklch(87.1% 0.22 148);
  --color-success-content: oklch(17.4% 0.045 148);

  --color-warning: oklch(95.5% 0.14 112.8);
  --color-warning-content: oklch(19.1% 0.03 112.8);

  --color-error: oklch(68.2% 0.21 24.4);
  --color-error-content: oklch(13.6% 0.045 24.4);

  /* Improved UI elements */
  --radius-selector: 0.3rem;
  --radius-field: 0.3rem;
  --radius-box: 0.3rem;

  --size-selector: 0.25rem;
  --size-field: 0.25rem;

  /* Added shadow for depth */
  --border: 0.5px;
  --depth: 0.2;
  --noise: 1;

  /* New variables for enhanced usability */
  --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.3);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
  --animation-duration: 200ms;
  --border-color: oklch(30% 0.02 277.5);
}

/* Light mode theme */
@plugin "daisyui/theme" {
  name: azure-light;
  default: true;
  prefersdark: false;
  color-scheme: light;

  /* Base colors */
  --color-base-100: oklch(98% 0.01 270);
  --color-base-200: oklch(95% 0.02 270);
  --color-base-300: oklch(92% 0.03 270);
  --color-base-content: oklch(27% 0.02 270);

  /* Primary colors */
  --color-primary: oklch(60% 0.18 275);
  --color-primary-content: oklch(96% 0.01 275);

  /* Secondary colors */
  --color-secondary: oklch(70% 0.15 240);
  --color-secondary-content: oklch(97% 0.01 240);

  /* Accent colors */
  --color-accent: oklch(65% 0.16 210);
  --color-accent-content: oklch(97% 0.01 210);

  /* State colors */
  --color-info: oklch(79% 0.12 212);
  --color-info-content: oklch(20% 0.02 212);
  --color-success: oklch(75% 0.16 148);
  --color-success-content: oklch(98% 0.01 148);
  --color-warning: oklch(82% 0.15 90);
  --color-warning-content: oklch(25% 0.03 90);
  --color-error: oklch(70% 0.18 24);
  --color-error-content: oklch(98% 0.01 24);

  /* Enhanced border radius for better visual appeal */
  --radius-selector: 0.75rem;
  --radius-field: 0.5rem;
  --radius-box: 0.75rem;

  /* Enhanced sizing for better touch targets */
  --size-selector: 0.3rem;
  --size-field: 0.3rem;

  /* Border settings */
  --border: 1px;

  /* Visual effects */
  --depth: 0.3;
  --noise: 0;
}

/* ======================= Enhanced Accessibility Styles ====================== */

/* Focus styles for better keyboard navigation */
button:focus-visible,
a:focus-visible,
input:focus-visible,
select:focus-visible,
textarea:focus-visible,
.tab:focus-visible,
.btn:focus-visible,
.menu-item:focus-visible,
[role="button"]:focus-visible {
  @apply outline-offset-2 outline-2 outline-primary;
}

/* Buttons */
.btn {
  @apply transition duration-200 min-w-[44px] min-h-[44px];
  @apply max-w-full w-full sm:w-auto; /* Ensure buttons never overflow on mobile */
  @apply px-4; /* Ensure enough horizontal padding for icon-only buttons */
}

/* Enforce minimum tap target for all icon-only and square buttons */
.btn-icon,
.btn-square,
.btn.btn-circle,
[aria-label][type="button"]:not(.btn) {
  min-width: 44px !important;
  min-height: 44px !important;
  width: 44px;
  height: 44px;
  @apply flex items-center justify-center p-0;
}

/* Add focus ring for icon-only buttons */
.btn.btn-circle:focus-visible,
.btn.btn-square:focus-visible,
.btn-icon:focus-visible,
[aria-label][type="button"]:focus-visible:not(.btn) {
  @apply outline-2 outline-primary outline-offset-2;
}

.btn:hover {
  @apply shadow-xs transform-gpu -translate-y-0.5; /* v4: shadow-xs is new default, consider shadow-xs if old v3 shadow-xs needed */
}

.btn:active, .btn:focus:active {
  @apply shadow-xs transform-gpu translate-y-0 active:bg-primary/20; /* see above */
}

/* Enhanced form field states */
.input:focus-visible,
.select:focus-visible,
.textarea:focus-visible {
  @apply ring-2 ring-primary;
}

.input-error,
.select-error,
.textarea-error {
  @apply border-error;
}

/* Input validation states */
.validator-success {
  @apply border-success;
}

.validator-error {
  @apply border-error;
}

.validator-hint {
  @apply text-xs mt-1 opacity-90;
}

.validator-hint-error {
  @apply text-error;
}

.validator-hint-success {
  @apply text-success;
}

/* Enhanced Modals */
.modal-box {
  @apply max-h-[90vh] overflow-y-auto w-full px-2;
  @apply max-w-full; /* Prevent modal overflow on mobile */
  @apply overflow-x-auto; /* Prevent horizontal overflow on small screens */
}

@media (max-width: 640px) {
  .modal-box {
    @apply max-w-xs px-2 w-full;
    @apply max-w-full;
    @apply overflow-x-auto;
  }
}

/* Enhanced Loading States */
.loading-container {
  @apply flex items-center justify-center p-4;
}

.loading-overlay {
  @apply absolute inset-0 bg-base-200 flex items-center justify-center z-50;
  /* For semi-transparency, use a slash alpha or RGBA in your HTML or an override. */
}

/* Enhanced Chat UI */
.chat-container {
  @apply flex flex-col space-y-4 p-4;
  @apply max-w-full w-full;
}

@media (max-width: 640px) {
  .chat-container {
    @apply p-2 space-y-2;
  }
}

.chat-user {
  @apply chat chat-end;
}

.chat-user .chat-bubble {
  @apply chat-bubble-primary;
}

.chat-ai {
  @apply chat chat-start;
}

.chat-ai .chat-bubble {
  @apply chat-bubble-neutral;
}

.chat-message-container {
  @apply w-full max-w-full overflow-x-auto whitespace-pre-wrap;
  /* For accessibility: allow vertical scroll for long content */
  max-height: 60vh;
  overflow-y: auto;
  @apply overflow-x-auto; /* Prevent horizontal overflow on small screens */
}

@media (max-width: 640px) {
  .chat-message-container {
    max-height: 40vh;
    @apply p-1;
    @apply overflow-x-auto;
  }
}

.chat-timestamp {
  @apply text-sm opacity-70 mt-1; /* Use text-sm for better readability on mobile */
}

/* Sticky chat input bar for mobile */
@media (max-width: 640px) {
  #projectChatContainer .flex.items-center.border-t,
  #globalChatContainer .flex.items-center.border-t {
    position: sticky;
    bottom: 0;
    background: var(--color-base-100, #fff);
    z-index: 10;
    @apply p-2;
  }
  #projectChatInput,
  #chatUIInput {
    @apply text-base;
  }
}

/* Ensure chat bubbles never overflow horizontally */
.chat-bubble {
  @apply max-w-full break-words;
  word-break: break-word; /* Fallback for old browsers lacking break-words */
}

/* Enhanced Knowledge Base UI */
.kb-result-card {
  @apply card bg-base-100 shadow-xs hover:shadow-md transition-all border border-base-300 cursor-pointer;
}

.kb-result-card:focus-visible {
  @apply outline-offset-2 outline-2 outline-primary;
}

.kb-result-relevance {
  @apply badge badge-sm;
}

.kb-result-relevance-high {
  @apply badge-success;
}

.kb-result-relevance-medium {
  @apply badge-warning;
}

.kb-result-relevance-low {
  @apply badge-ghost;
}

/* Responsive Stats Panel */
@media (max-width: 640px) {
  .stats {
    @apply flex flex-col space-y-4;
  }
  .stat {
    @apply w-full;
  }
}

/* Enhanced Sidebar Navigation */
.sidebar-nav {
  @apply menu menu-vertical p-2 bg-base-200 w-full rounded-box;
}

@media (max-width: 640px) {
  .sidebar {
    @apply w-4/5 max-w-xs fixed inset-0 z-50 transition-transform duration-300;
    @apply bg-base-100; /* Use theme background */
    /* Removed hardcoded background: rgba(0,0,0,0.3); */
    height: 100dvh;
    min-height: calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom));
    padding-top: env(safe-area-inset-top, 0);
    padding-bottom: env(safe-area-inset-bottom, 0);
    @apply flex flex-col overflow-y-auto touch-pan-y;
    -webkit-overflow-scrolling: touch;
    overscroll-behavior-y: contain;
  }
  .sidebar-nav {
    @apply p-4;
  }
  /* Sidebar Backdrop Overlay for Mobile (if applicable) */
  .sidebar-backdrop {
    @apply fixed inset-0 z-40 bg-base-300/70;
    padding-bottom: env(safe-area-inset-bottom, 0);
  }
  /* Sidebar sticky dock (bottom nav bar for actions) */
  .sidebar-dock {
    @apply fixed bottom-0 left-0 w-full bg-base-100 border-t border-base-300 z-50 flex justify-around items-center;
    padding-bottom: env(safe-area-inset-bottom, 0);
    min-height: 56px;
    gap: 0.5rem;
  }
}

.sidebar-nav-item {
  @apply font-medium min-h-[44px] min-w-[44px];
}

.sidebar-nav-item.active {
  @apply bg-primary text-primary-content;
}

/* Enhanced Tabs */
.enhanced-tabs {
  @apply gap-1 overflow-x-auto whitespace-nowrap;
  -webkit-overflow-scrolling: touch;
}

.enhanced-tab {
  @apply transition-all duration-200 min-w-[44px] min-h-[44px] px-3;
}

.enhanced-tab.tab-active {
  @apply font-medium;
}

/* Enhanced Skeleton Loading State */
.skeleton-card {
  @apply card shadow-xs border border-base-300 animate-pulse p-4 bg-base-200;
}

.skeleton-text {
  @apply h-4 bg-base-300 rounded my-2;
}

.skeleton-circle {
  @apply h-12 w-12 bg-base-300 rounded-full;
}

/* Enhanced File Upload Zones */
.upload-zone {
  @apply border-2 border-dashed border-base-300 rounded-box p-8 text-center transition-all duration-300;
}

@media (max-width: 640px) {
  .upload-zone {
    @apply p-4;
  }
  .file-preview {
    @apply flex-col items-start gap-2 w-full;
  }
  .file-preview-remove {
    @apply min-w-[44px] min-h-[44px];
  }
}

/* Enforce minimum tap target for file preview remove buttons */
.file-preview-delete,
.file-preview-remove {
  min-width: 44px !important;
  min-height: 44px !important;
  width: 44px;
  height: 44px;
  @apply flex items-center justify-center p-0;
}

.upload-zone-active {
  @apply border-primary bg-primary;
  /* For partial opacity, use e.g. border-primary/70 bg-primary/5 in HTML. */
}

.upload-zone-error {
  @apply border-error bg-error;
}

.file-preview {
  @apply p-2 border border-base-300 rounded-box flex items-center gap-2 bg-base-100 mt-2 w-full;
}

.file-preview-icon {
  @apply text-lg opacity-70;
}

.file-preview-name {
  @apply flex-1 truncate text-sm;
  @apply max-w-full;
}

.file-preview-size {
  @apply text-xs opacity-70;
}

.file-preview-remove {
  @apply btn btn-ghost btn-md btn-square text-error min-w-[44px] min-h-[44px];
}

/* Enhanced Notification Styling */
#notificationContainer .alert {
  opacity: 1;
}

/* HIGH CONTRAST NOTIFICATION VARIANTS */
.notification-success,
.notification-error,
.notification-warning,
.notification-info {
  background: #fff !important;
  color: #1a1a1a !important;
  @apply shadow-md max-w-sm duration-300 text-sm font-normal px-3 py-2 flex items-center border-l-[4px];
  border-radius: 0.33rem;
  min-width: 220px;
  max-width: 90vw;
  word-break: break-word;
}
.notification-success {
  border-left: 6px solid #047857 !important; /* emerald-700 dark/green */
}
.notification-error {
  border-left: 6px solid #d32f2f !important; /* red-700 */
}
.notification-warning {
  border-left: 6px solid #f59e42 !important; /* orange-400 */
}
.notification-info {
  border-left: 6px solid #2563eb !important; /* blue-700 */
}

.notification-heading {
  font-weight: 700;
  font-size: 1em;
  margin-right: 0.6em;
  letter-spacing: 0.02em;
  line-height: 1.1;
}

/* Increase icon size and keep type color for icon only */
.notification-success svg {
  color: #047857 !important;
  width: 1.25rem;
  height: 1.25rem;
}
.notification-error svg {
  color: #d32f2f !important;
  width: 1.25rem;
  height: 1.25rem;
}
.notification-warning svg {
  color: #f59e42 !important;
  width: 1.25rem;
  height: 1.25rem;
}
.notification-info svg {
  color: #2563eb !important;
  width: 1.25rem;
  height: 1.25rem;
}

.notification-item span:not(.notification-heading) {
  font-size: 0.98em;
  font-weight: 400;
  color: #212121 !important;
  word-break: break-word;
}

@media (max-width: 640px) {
  .notification-success,
  .notification-error,
  .notification-warning,
  .notification-info {
    font-size: 0.96rem;
    padding: 0.79em 0.9em;
    min-width: 0;
    border-radius: 0.22rem;
  }
}


/* Remove alert-info background override for all but pure alert-info to avoid color leaks */
.alert-info {
  background: rgba(56, 189, 248, 0.15) !important;
}

/* Enhanced Form Control Styling */
.form-control-enhanced {
  @apply relative mb-4;
}

.form-control-enhanced label {
  @apply block text-base font-semibold mb-1;
}

@media (max-width: 640px) {
  .form-control-enhanced {
    @apply space-y-4; /* Add extra vertical spacing between stacked form fields on mobile */
  }
}

.form-control-enhanced .input,
.form-control-enhanced .select,
.form-control-enhanced .textarea {
  @apply w-full text-sm;
}

.form-control-enhanced .error-message {
  @apply text-sm text-error mt-1 absolute -bottom-5;
}

/* More accessible floating labels */
.floating-label {
  @apply relative;
}

.floating-label input,
.floating-label textarea {
  @apply placeholder-transparent text-base; /* Use text-base for better readability */
}

.floating-label span {
  @apply absolute left-3 -top-2 px-1 text-sm transition-all pointer-events-none bg-base-100 text-base-content/70;
}

.floating-label input:placeholder-shown+span,
.floating-label textarea:placeholder-shown+span {
  @apply top-1/2 -translate-y-1/2 text-base;
}

.floating-label input:focus+span,
.floating-label textarea:focus+span {
  @apply -top-2 text-sm text-primary;
}

/* A11y improvements */
.sr-only {
  @apply absolute w-px h-px p-0 -m-px overflow-hidden whitespace-nowrap border-0;
}

.skip-to-content {
  @apply sr-only focus:not-sr-only focus:fixed focus:top-4 focus:left-4 focus:z-50 focus:p-2 focus:bg-primary focus:text-primary-content focus:rounded;
  @apply max-w-full;
}

/* Responsive vertical spacing for stacked elements */
@media (max-width: 640px) {
  .space-y-mobile {
    @apply space-y-4;
  }
}

/* Status Indicators */
.status-indicator {
  @apply flex items-center gap-2;
}

.status-indicator-dot {
  @apply status;
}

.status-indicator-dot-active {
  @apply status-success;
}

.status-indicator-dot-inactive {
  @apply status-error;
}

.status-indicator-dot-pending {
  @apply status-warning;
}

.status-indicator-text {
  @apply text-sm;
}

/* Keyboard Shortcuts */
.kbd-container {
  @apply flex flex-wrap gap-1 text-sm text-base-content/70;
}

.kbd-shortcut {
  @apply kbd kbd-md; /* Use medium size for better readability on mobile */
}

/* Better Tables for Data */
.data-table {
  @apply table table-zebra w-full text-sm;
}

.data-table-container {
  @apply overflow-x-auto rounded-box border border-base-300 bg-base-100;
}

.data-table-heading {
  @apply text-base uppercase tracking-wider;
}

.data-table-row {
  @apply hover:bg-base-200/50 transition-colors duration-150;
}

.data-table-cell {
  @apply py-2 px-4;
}

.data-table-actions {
  @apply flex gap-1 justify-end;
}

/* Table/Code Overflow Scroll Indicator */
@media (max-width: 640px) {
  .data-table-container::after,
  pre[data-sanitize="true"]::after {
    content: "← scroll for more →";
    display: block;
    text-align: center;
    color: #888;
    font-size: 1rem;
    margin-top: 0.25rem;
    opacity: 0.7;
  }
}

/* Utility: Ensure all cards, modals, and fixed-width containers are responsive */
.card,
.stats,
.modal,
.modal-box,
.project-card,
.file-preview-item,
.kb-result-card {
  @apply max-w-full w-full;
  @apply overflow-x-auto;
}

/* Enhanced Responsive Project List Grid */
.project-list, /* for main projectList grid container */
.grid.project-list, /* fallback: for dynamically rendered container */
#projectList > .grid,
#projectList .grid {
  @apply grid grid-cols-1 gap-6 py-2 overflow-x-hidden;
  -webkit-overflow-scrolling: touch;
  touch-action: pan-y;
}

/* Responsive adjustments for project cards in grid */
@media (max-width: 640px) {
  .project-card {
    @apply min-w-0 max-w-full w-full rounded-box;
    margin-left: 0 !important;
    margin-right: 0 !important;
  }
  .project-list {
    @apply gap-3 py-2;
  }
}

/* Make sure loading/error/empty state is always centered and responsive */
.project-list-fallback,
.project-list-error,
.project-list-empty {
  @apply col-span-1 text-center py-8 text-base-content/60 text-sm font-medium flex flex-col items-center justify-center w-full;
}


/* Utility: Avoid text-xs for essential info on mobile */
@media (max-width: 640px) {
  .text-xs {
    font-size: 0.875rem !important; /* This is text-sm size. Rename the utility or explain via comment. */
    line-height: 1.25rem !important;
    /* Consider defining a mobile-only text-sm class, or use `text-sm` directly. */
  }
}

/* Utility: Limit line length for better readability */
.prose, .prose-lg, .prose-md, .prose-sm, .prose-base, .prose-xl, .prose-2xl, .prose-3xl, .prose-4xl, .prose-5xl, .prose-6xl {
  max-width: 75ch;
}

/* Utility: Ensure all images are lazy-loaded by default (for HTML, not CSS) */
/* [No CSS needed, but document for devs: use loading="lazy" on <img> tags] */

/* Include DaisyUI plugin at the end if not in aggregator */
/* @plugin "daisyui"; */
